<div class="movie-card">
  <!-- –ü–æ—Å—Ç–µ—Ä —Ñ–∏–ª—å–º–∞ -->
  <div class="poster-container">
    @if (movie.posterUrl) {
      <img
        [src]="movie.posterUrl"
        [alt]="movie.title"
        class="poster"
        (error)="onImageError($event)"
        loading="lazy"
      >
    } @else {
      <div class="poster-placeholder">üé¨</div>
    }

    <!-- –í–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Ä–µ–π—Ç–∏–Ω–≥ -->
    <div class="age-rating">
      {{ movie.ageRating }}
    </div>

    <!-- –ì–æ–¥ –≤—ã–ø—É—Å–∫–∞ -->
    <div class="year-badge">
      {{ getYear(movie.releaseDate) }}
    </div>
  </div>

  <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∏–ª—å–º–µ -->
  <div class="movie-info">
    <h3 class="movie-title">{{ movie.title }}</h3>

    <!-- –ñ–∞–Ω—Ä—ã -->
    <div class="genres">
      @for (genre of movie.genres; track genre) {
        <span class="genre-tag">{{ genre }}</span>
      }
    </div>

    <!-- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å -->
    <div class="duration">
      <span class="icon">‚è±Ô∏è</span>
      <span>{{ movie.duration }} –º–∏–Ω.</span>
    </div>

    <!-- –û–ø–∏—Å–∞–Ω–∏–µ (–µ—Å–ª–∏ –µ—Å—Ç—å) -->
    @if (movie.description) {
      <p class="description">
        {{ truncateDescription(movie.description) }}
      </p>
    }
  </div>

  <!-- –°–µ–∞–Ω—Å—ã (–ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ) -->
  @if (showSessions) {
    <div class="sessions-section">
      @if (hasSessions) {
        <h4 class="sessions-title">–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ–∞–Ω—Å—ã:</h4>

        @for (sessionGroup of sessionDates; track sessionGroup.date) {
          <div class="session-date-group">
            <div class="date-header">
              <span class="date-label">
                @if (sessionGroup.date === '–°–∫–æ—Ä–æ') {
                  –°–∫–æ—Ä–æ
                } @else {
                  {{ sessionGroup.date | date:'dd.MM.yyyy' }}
                }
              </span>
              <span class="session-count">
                {{ sessionGroup.sessions.length }} —Å–µ–∞–Ω—Å–∞
              </span>
            </div>

            <div class="session-times">
              @for (session of sessionGroup.sessions; track session.sessionId) {
                <a
                  [routerLink]="['/session', session.sessionId]"
                  class="session-time-btn"
                  [title]="'–ë–∏–ª–µ—Ç—ã –Ω–∞ ' + formatSessionTime(session.dateTime)"
                >
                  {{ formatSessionTime(session.dateTime) }}
                </a>
              }
            </div>
          </div>
        }
      } @else {
        <div class="no-sessions">
          <p>üé≠ –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–µ–∞–Ω—Å–æ–≤</p>
        </div>
      }
    </div>
  }

  <!-- –ö–Ω–æ–ø–∫–∞ –ø–æ–¥—Ä–æ–±–Ω–µ–µ -->
  <div class="actions">
    <a
      [routerLink]="['/movie', movie.filmId]"
      class="details-btn"
    >
      –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ñ–∏–ª—å–º–µ
    </a>
  </div>
</div>
